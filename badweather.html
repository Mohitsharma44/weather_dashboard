<!DOCTYPE html>
<html>
<head>
	<title> Bad Weather</title>
	<script type="text/javascript" src="http://mbostock.github.com/d3/d3.js"></script>
	<style type="text/css">

		body {
			font-family: "Verdana", Verdana, sans-serif;
  			background: #222;
		}
		rect {
  			fill: none;
  			pointer-events: all;
		}

		circle {
 			fill: none;
  			stroke-width: 0.5px;
		}
		            div.tooltip {   
              position: absolute;           
              text-align: center;           
              width: 100px;                  
              height: 28px;                 
              padding: 2px;             
              font: 12px sans-serif;        
              background: lightsteelblue;   
              border: 0px;      
              border-radius: 8px;           
              pointer-events: none;         
          }

	</style>
</head>
<body>

<p></p>
	<script type="text/javascript">
	d3.json("jan.json", function(data){
		d3.json("month.json", function(month){
		var margin = {top: 20, bottom: 20, right: 20, left: 20}
		var width = 1500;
		var height = 1000;
		var i = 0;
		var i = 0;
        var count = 0;
        var y = 0;


		//var canvas = d3.select("body").append("svg")
	//		.attr("width", width)
	//		.attr("height", height)
	//		.attr("fill","black")

		 var div = d3.select("body").append("div")   
                .attr("class", "tooltip")               
                .style("opacity", 0);

         var svg = d3.select("body")
                .append("svg")
                .attr("width", width)
                .attr("height", height)
                svg.call(head);


//-- Follows mouse cursor drawing circles around it --//
	/*	canvas.append("rect")
			.attr("width", width)
			.attr("height", height)
			.on("ontouchstart" in document ? "touchmove" : "mousemove", particle)

		function particle(){
			var m = d3.mouse(this);

		canvas.insert("circle", "rect")
			.attr("cx", m[0])
      		.attr("cy", m[1])
      		.attr("r", 1e-6)
      		.style("stroke", d3.hsl((i = (i + 1) % 360), 1, .5))
      		.style("stroke-opacity", 1)
    	.transition()
      		.duration(2000)
      		.ease(Math.sqrt)
      		.attr("r", 10)
      		.style("stroke-opacity", 1e-6)
      		.remove();

      	d3.event.preventDefault();
  		}
	*/

//-- Reduce font to normal size on mouseout --//
	function stillhead(){ 
		d3.select(this)
		.transition()
		.duration(1000)
		.delay(500)
		.text(function (d) { return d.name; }).style("opacity", 1).attr("font-size", "17px")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
	}
		function stillhead2(){ 
		d3.select(this)
		.transition()
		.duration(1000)
		.delay(500)
		.text(function (d) { return d; }).style("opacity", 1).attr("font-size", "17px")
		.attr("transform", "translate(" + margin.left + "," + 60 + ")");
	}

//-- Growing font when hovered over particular string --//
	function animatehead(){
		d3.select(this)
		.transition()  
		.delay(200)                     
		.duration(1000)
		.text(function (d) { return d.name; }).style("opacity", 1).attr("font-size", "34px");
        //.attr("font-size", "64px");
    }

	function animatehead2(){
		d3.select(this)
		.transition()  
		.delay(200)                     
		.duration(1000)
		.text(function (d) { return d; }).style("opacity", 1).attr("font-size", "34px");
    }
            
    function head(){
    		svg.selectAll("body")
			.data(month)
			.enter()
				.append("text")
				.attr("fill", "white")
				.attr("x", function (d, i) { return i * 120 + 20; })
				.text(function (d) { return d.name; })
				.attr("transform", "translate(" + margin.left + "," + margin.top + ")")
				.on("mouseover", animatehead)
				.on("mouseout", stillhead)
				.on("mousedown", head2);
	}

	function head2(){
				a = [1, 2, 3]
				svg.selectAll('body').data(a).enter().append('text')
				.attr("fill", "white")
				.text(function (d, i) {return a[i];})
				.attr("x", function (d, i) { return i * 50 + 20; })
				.attr("transform", "translate(" + margin.left + "," + 60 + ")")
				.on("mousedown", one)
				.on("mouseover", animatehead2)
				.on("mouseout", stillhead2);
				
	}

    function one(){
            //var imgs = svg.selectAll("body").data(data)
                svg.selectAll("body").data(data)
                .enter()
                .append("image")
                .attr("xlink:href", function (d) { return d.jan; })
                .attr("x", function (d, i) { 
                    return i%9 * 120; })
                .attr("y", function (d, i) {
                    count = i%9 + 2; 
                    if (count == 10){
                        y = y + 1;
                    }
                    return y*120; })
                //.text(function (d) {return d.name;})
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
                .attr("width", "80")
                .attr("height", "80")
                .on("dblclick", dblclick)
                .on("mouseover", function(d) { 
                    div.transition()
                        .duration(500)    
                        .style("opacity", 0)     
                    div.transition()        
                        .duration(200)      
                        .style("opacity", .9)      
                    div.html(
                    '<a href= "'+d.jan+'" target="_blank">' +d.jan+"</a>")  
                    .style("left", (d3.event.pageX) + "px")     
                    .style("top", (d3.event.pageY - 28) + 
                        "px");    
                })                  

            }
            
            function dblclick(d){
                window.location.assign(d.jan);
            }

	})
	})
	
	

	</script>


</body>
</html>